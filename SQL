https://www.mssqltips.com/sqlservertip/11506/sql-partition-by-examples-for-aggregating-data/
